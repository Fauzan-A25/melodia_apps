import{i as e,m as t,n,p as r,r as i,u as a}from"./index-D0xoUJhe.js";var o=t(r(),1),s={container:`_container_15g1z_5`,header:`_header_15g1z_17`,loadingContainer:`_loadingContainer_15g1z_61`,spinner:`_spinner_15g1z_81`,spin:`_spin_15g1z_81`,errorBanner:`_errorBanner_15g1z_113`,form:`_form_15g1z_171`,formRow:`_formRow_15g1z_199`,formGroup:`_formGroup_15g1z_211`,select:`_select_15g1z_241`,genreGrid:`_genreGrid_15g1z_327`,genreCheckbox:`_genreCheckbox_15g1z_347`,createBtn:`_createBtn_15g1z_401`,tableWrapper:`_tableWrapper_15g1z_449`,table:`_table_15g1z_449`,albumCover:`_albumCover_15g1z_553`,titleCell:`_titleCell_15g1z_577`,genreCell:`_genreCell_15g1z_587`,songCountCell:`_songCountCell_15g1z_599`,actionButtons:`_actionButtons_15g1z_613`,manageSongsBtn:`_manageSongsBtn_15g1z_627`,deleteBtn:`_deleteBtn_15g1z_667`,modalOverlay:`_modalOverlay_15g1z_705`,fadeIn:`_fadeIn_15g1z_1`,modal:`_modal_15g1z_705`,slideUp:`_slideUp_15g1z_1`,modalHeader:`_modalHeader_15g1z_803`,closeBtn:`_closeBtn_15g1z_835`,modalContent:`_modalContent_15g1z_873`,addSongSection:`_addSongSection_15g1z_927`,addSongForm:`_addSongForm_15g1z_953`,songSelect:`_songSelect_15g1z_963`,addBtn:`_addBtn_15g1z_1011`,currentSongsSection:`_currentSongsSection_15g1z_1069`,emptyMessage:`_emptyMessage_15g1z_1083`,songsList:`_songsList_15g1z_1105`,songItem:`_songItem_15g1z_1123`,songNumber:`_songNumber_15g1z_1157`,songInfo:`_songInfo_15g1z_1179`,songTitle:`_songTitle_15g1z_1195`,songArtist:`_songArtist_15g1z_1213`,removeSongBtn:`_removeSongBtn_15g1z_1229`,emptyState:`_emptyState_15g1z_1271`,editModal:`_editModal_15g1z_1559`,editModalHeader:`_editModalHeader_15g1z_1569`,editFormGroup:`_editFormGroup_15g1z_1577`,editGenreGrid:`_editGenreGrid_15g1z_1585`,editModalOverlay:`_editModalOverlay_15g1z_1599`,editCloseBtn:`_editCloseBtn_15g1z_1685`,editModalForm:`_editModalForm_15g1z_1723`,editGenreCheckbox:`_editGenreCheckbox_15g1z_1827`,editModalActions:`_editModalActions_15g1z_1887`,editCancelBtn:`_editCancelBtn_15g1z_1903`,editSaveBtn:`_editSaveBtn_15g1z_1905`,editBtn:`_editBtn_15g1z_1981`},c=t(a(),1),l=()=>{let[t,r]=(0,o.useState)([]),[a,l]=(0,o.useState)([]),[u,d]=(0,o.useState)([]),[f,p]=(0,o.useState)([]),[m,h]=(0,o.useState)(!0),[g,_]=(0,o.useState)(``),[v,y]=(0,o.useState)(null),[b,x]=(0,o.useState)(``),[S,C]=(0,o.useState)(!1),[w,T]=(0,o.useState)({title:``,artistId:``,releaseYear:new Date().getFullYear(),genreNames:[]}),[E,D]=(0,o.useState)(!1),[O,k]=(0,o.useState)(null),[A,j]=(0,o.useState)({title:``,releaseYear:new Date().getFullYear(),genreNames:[]}),[M,N]=(0,o.useState)(!1),P=(0,o.useCallback)(async()=>{try{h(!0),_(``);let[t,i,a,o]=await Promise.all([e.getAllAlbums(),n.getAllGenres(),n.getArtistsForDropdown(),e.getAllSongs()]);r(t||[]),d(i||[]),l(a||[]),p(o||[])}catch(e){console.error(`Error loading data:`,e),_(i(e)||`Failed to load data. Please try again.`)}finally{h(!1)}},[]);(0,o.useEffect)(()=>{P()},[P]);let F=e=>{let{name:t,value:n}=e.target;T(e=>({...e,[t]:n}))},I=e=>{T(t=>({...t,genreNames:t.genreNames.includes(e)?t.genreNames.filter(t=>t!==e):[...t.genreNames,e]}))},L=async t=>{if(t.preventDefault(),!w.title.trim()){alert(`Album title is required`);return}if(!w.artistId){alert(`Please select an artist`);return}if(!w.genreNames||w.genreNames.length===0){alert(`At least 1 genre is required`);return}try{D(!0),await e.createAlbum(w.title,w.artistId,w.releaseYear,w.genreNames),T({title:``,artistId:``,releaseYear:new Date().getFullYear(),genreNames:[]}),await P(),alert(`Album created successfully!`)}catch(e){console.error(`Error creating album:`,e),alert(i(e)||`Failed to create album`)}finally{D(!1)}},R=async t=>{if(window.confirm(`Are you sure you want to delete this album?`))try{await e.deleteAlbum(t),await P(),alert(`Album deleted successfully!`)}catch(e){console.error(`Error deleting album:`,e),alert(i(e)||`Failed to delete album`)}},z=e=>{k(e),j({title:e.title,releaseYear:e.releaseYear,genreNames:e.genreNames||e.genres?.map(e=>e.name)||[]})},B=()=>{k(null),j({title:``,releaseYear:new Date().getFullYear(),genreNames:[]})},V=e=>{j(t=>({...t,genreNames:t.genreNames.includes(e)?t.genreNames.filter(t=>t!==e):[...t.genreNames,e]}))},H=async e=>{if(e.preventDefault(),!A.title.trim()){alert(`Album title is required`);return}if(!A.genreNames||A.genreNames.length===0){alert(`At least 1 genre is required`);return}N(!0);try{await n.updateAlbum(O.albumId,A.title.trim(),A.releaseYear,A.genreNames),await P(),B(),alert(`Album updated successfully!`)}catch(e){console.error(`Error updating album:`,e),alert(i(e)||`Failed to update album`)}finally{N(!1)}},U=async t=>{y(null),x(``),C(!0);try{y(await e.getAlbumById(t.albumId))}catch(e){console.error(`Failed to load album details:`,e),alert(i(e)||`Failed to load album details`)}finally{C(!1)}},W=()=>{y(null),x(``)},G=(0,o.useMemo)(()=>{if(!v)return[];let e=v.artist?.artistId||v.artistId||null;return console.log(`[AlbumManagement] selectedAlbum artistId =`,e),f.filter(t=>{let n=t.artist?.artistId||t.artistId||null;return e&&n===e})},[f,v]),K=async()=>{if(!v||!b){alert(`Please select a song`);return}let t=f.find(e=>e.songId===b);console.log(`[handleAddSongToAlbum] DEBUG`,{albumId:v.albumId,albumArtistId:v.artist?.artistId||v.artistId,albumArtistName:v.artist?.artistName||v.artistName,songId:t?.songId,songArtistId:t?.artist?.artistId||t?.artistId,songArtistName:t?.artist?.artistName||t?.artistName});try{C(!0),await e.addSongToAlbum(v.albumId,b),y(await e.getAlbumById(v.albumId)),await P(),alert(`Song added to album!`)}catch(e){console.error(`Error adding song to album:`,e),alert(i(e)||`Failed to add song to album`)}finally{C(!1)}},q=async t=>{if(v&&window.confirm(`Remove this song from album?`))try{C(!0),await e.removeSongFromAlbum(v.albumId,t),y(await e.getAlbumById(v.albumId)),await P()}catch(e){console.error(`Error removing song from album:`,e),alert(i(e)||`Failed to remove song from album`)}finally{C(!1)}};return m?(0,c.jsxs)(`div`,{className:s.loadingContainer,children:[(0,c.jsx)(`div`,{className:s.spinner,children:`â³`}),(0,c.jsx)(`p`,{children:`Loading albums...`})]}):(0,c.jsxs)(`div`,{className:s.container,children:[(0,c.jsxs)(`div`,{className:s.header,children:[(0,c.jsx)(`h1`,{children:`Album Management`}),(0,c.jsx)(`p`,{children:`Create and manage music albums`})]}),g&&(0,c.jsxs)(`div`,{className:s.errorBanner,children:[(0,c.jsx)(`span`,{children:g}),(0,c.jsx)(`button`,{onClick:P,children:`Retry`})]}),(0,c.jsxs)(`form`,{className:s.form,onSubmit:L,children:[(0,c.jsxs)(`div`,{className:s.formRow,children:[(0,c.jsxs)(`div`,{className:s.formGroup,children:[(0,c.jsx)(`label`,{htmlFor:`title`,children:`Album Title *`}),(0,c.jsx)(`input`,{type:`text`,id:`title`,name:`title`,value:w.title,onChange:F,placeholder:`Enter album title`,disabled:E,required:!0})]}),(0,c.jsxs)(`div`,{className:s.formGroup,children:[(0,c.jsx)(`label`,{htmlFor:`artistId`,children:`Artist *`}),(0,c.jsxs)(`select`,{id:`artistId`,name:`artistId`,value:w.artistId,onChange:F,disabled:E,required:!0,className:s.select,children:[(0,c.jsx)(`option`,{value:``,children:`Select Artist`}),a.map(e=>(0,c.jsx)(`option`,{value:e.artistId,children:e.artistName},e.artistId))]})]}),(0,c.jsxs)(`div`,{className:s.formGroup,children:[(0,c.jsx)(`label`,{htmlFor:`releaseYear`,children:`Release Year *`}),(0,c.jsx)(`input`,{type:`number`,id:`releaseYear`,name:`releaseYear`,value:w.releaseYear,onChange:F,min:`1900`,max:new Date().getFullYear()+1,disabled:E,required:!0})]})]}),(0,c.jsxs)(`div`,{className:s.formGroup,children:[(0,c.jsx)(`label`,{children:`Genres (Required *)`}),(0,c.jsx)(`div`,{className:s.genreGrid,children:u.map(e=>(0,c.jsxs)(`label`,{className:s.genreCheckbox,children:[(0,c.jsx)(`input`,{type:`checkbox`,checked:w.genreNames.includes(e.name),onChange:()=>I(e.name),disabled:E}),(0,c.jsx)(`span`,{children:e.name})]},e.id||e.name))})]}),(0,c.jsx)(`button`,{type:`submit`,className:s.createBtn,disabled:E,children:E?`Creating...`:`Create Album`})]}),(0,c.jsx)(`div`,{className:s.tableWrapper,children:(0,c.jsxs)(`table`,{className:s.table,children:[(0,c.jsx)(`thead`,{children:(0,c.jsxs)(`tr`,{children:[(0,c.jsx)(`th`,{children:`Cover`}),(0,c.jsx)(`th`,{children:`Title`}),(0,c.jsx)(`th`,{children:`Artist`}),(0,c.jsx)(`th`,{children:`Release Year`}),(0,c.jsx)(`th`,{children:`Genres`}),(0,c.jsx)(`th`,{children:`Songs`}),(0,c.jsx)(`th`,{children:`Actions`})]})}),(0,c.jsx)(`tbody`,{children:t.length===0?(0,c.jsx)(`tr`,{children:(0,c.jsx)(`td`,{colSpan:`7`,className:s.emptyState,children:(0,c.jsx)(`p`,{children:`No albums found. Create your first album above!`})})}):t.map(e=>(0,c.jsxs)(`tr`,{children:[(0,c.jsx)(`td`,{"data-label":`Cover`,children:(0,c.jsx)(`div`,{className:s.albumCover,children:e.coverEmoji||`ðŸ’¿`})}),(0,c.jsx)(`td`,{"data-label":`Title`,className:s.titleCell,children:e.title}),(0,c.jsx)(`td`,{"data-label":`Artist`,children:e.artistName||e.artist?.artistName||e.artist?.name||`Unknown`}),(0,c.jsx)(`td`,{"data-label":`Year`,children:e.releaseYear}),(0,c.jsx)(`td`,{"data-label":`Genres`,className:s.genreCell,children:e.genreNames&&e.genreNames.length>0?e.genreNames.join(`, `):e.genres&&e.genres.length>0?e.genres.map(e=>e.name).join(`, `):`No genres`}),(0,c.jsx)(`td`,{"data-label":`Songs`,className:s.songCountCell,children:(e.songCount??e.songs?.length??0)+` songs`}),(0,c.jsx)(`td`,{"data-label":`Actions`,children:(0,c.jsxs)(`div`,{className:s.actionButtons,children:[(0,c.jsx)(`button`,{type:`button`,className:s.editBtn,onClick:()=>z(e),children:`âœï¸ Edit`}),(0,c.jsx)(`button`,{type:`button`,className:s.manageSongsBtn,onClick:()=>U(e),children:`ðŸŽµ Manage Songs`}),(0,c.jsx)(`button`,{className:s.deleteBtn,onClick:()=>R(e.albumId),children:`Delete`})]})})]},e.albumId))})]})}),v&&(0,c.jsx)(`div`,{className:s.modalOverlay,children:(0,c.jsxs)(`div`,{className:s.modal,children:[(0,c.jsxs)(`div`,{className:s.modalHeader,children:[(0,c.jsxs)(`h2`,{children:[`Manage Songs â€“ `,v.title,` (`,v.releaseYear,`)`]}),(0,c.jsx)(`button`,{type:`button`,className:s.closeBtn,onClick:W,children:`âœ•`})]}),(0,c.jsxs)(`div`,{className:s.modalContent,children:[(0,c.jsxs)(`div`,{className:s.addSongSection,children:[(0,c.jsx)(`h3`,{children:`Add song to album`}),(0,c.jsxs)(`div`,{className:s.addSongForm,children:[(0,c.jsxs)(`select`,{className:s.songSelect,value:b,onChange:e=>x(e.target.value),disabled:S,children:[(0,c.jsx)(`option`,{value:``,children:`Select song`}),G.map(e=>(0,c.jsxs)(`option`,{value:e.songId,children:[e.title,` â€“`,` `,e.artist?.artistName||e.artistName||`Unknown`]},e.songId))]}),(0,c.jsx)(`button`,{type:`button`,className:s.addBtn,onClick:K,disabled:S||!G.length,children:S?`Adding...`:`Add Song`})]})]}),(0,c.jsxs)(`div`,{className:s.currentSongsSection,children:[(0,c.jsx)(`h3`,{children:`Current songs in album`}),!v.songs||v.songs.length===0?(0,c.jsx)(`div`,{className:s.emptyMessage,children:`No songs in this album yet.`}):(0,c.jsx)(`ul`,{className:s.songsList,children:v.songs.map((e,t)=>(0,c.jsxs)(`li`,{className:s.songItem,children:[(0,c.jsx)(`div`,{className:s.songNumber,children:t+1}),(0,c.jsxs)(`div`,{className:s.songInfo,children:[(0,c.jsx)(`div`,{className:s.songTitle,children:e.title}),(0,c.jsx)(`div`,{className:s.songArtist,children:e.artist?.artistName||e.artistName||`Unknown`})]}),(0,c.jsx)(`button`,{type:`button`,className:s.removeSongBtn,onClick:()=>q(e.songId),disabled:S,children:`âœ•`})]},e.songId))})]})]})]})}),O&&(0,c.jsx)(`div`,{className:s.editModalOverlay,onClick:B,children:(0,c.jsxs)(`div`,{className:s.editModal,onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)(`div`,{className:s.editModalHeader,children:[(0,c.jsx)(`h2`,{children:`Edit Album`}),(0,c.jsx)(`button`,{type:`button`,className:s.editCloseBtn,onClick:B,children:`âœ•`})]}),(0,c.jsxs)(`form`,{onSubmit:H,className:s.editModalForm,children:[(0,c.jsxs)(`div`,{className:s.editFormGroup,children:[(0,c.jsx)(`label`,{htmlFor:`editTitle`,children:`Album Title *`}),(0,c.jsx)(`input`,{type:`text`,id:`editTitle`,value:A.title,onChange:e=>j(t=>({...t,title:e.target.value})),placeholder:`Album title`,disabled:M,required:!0,autoFocus:!0})]}),(0,c.jsxs)(`div`,{className:s.editFormGroup,children:[(0,c.jsx)(`label`,{htmlFor:`editReleaseYear`,children:`Release Year *`}),(0,c.jsx)(`input`,{type:`number`,id:`editReleaseYear`,value:A.releaseYear,onChange:e=>j(t=>({...t,releaseYear:parseInt(e.target.value)})),min:`1900`,max:new Date().getFullYear()+1,disabled:M,required:!0})]}),(0,c.jsxs)(`div`,{className:s.editFormGroup,children:[(0,c.jsx)(`label`,{children:`Genres (Required *)`}),(0,c.jsx)(`div`,{className:s.editGenreGrid,children:u.map(e=>(0,c.jsxs)(`label`,{className:s.editGenreCheckbox,children:[(0,c.jsx)(`input`,{type:`checkbox`,checked:A.genreNames.includes(e.name),onChange:()=>V(e.name),disabled:M}),(0,c.jsx)(`span`,{children:e.name})]},e.id||e.name))})]}),(0,c.jsxs)(`div`,{className:s.editModalActions,children:[(0,c.jsx)(`button`,{type:`button`,className:s.editCancelBtn,onClick:B,disabled:M,children:`Cancel`}),(0,c.jsx)(`button`,{type:`submit`,className:s.editSaveBtn,disabled:M,children:M?`Saving...`:`Save Changes`})]})]})]})})]})};export{l as default};