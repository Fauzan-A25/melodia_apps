import{m as e,n as t,p as n,u as r}from"./index-D0xoUJhe.js";var i=e(n(),1),a={container:`_container_109tg_5`,header:`_header_109tg_19`,error:`_error_109tg_59`,controls:`_controls_109tg_83`,searchInput:`_searchInput_109tg_107`,filterSelect:`_filterSelect_109tg_151`,stats:`_stats_109tg_199`,empty:`_empty_109tg_231`,tableContainer:`_tableContainer_109tg_253`,table:`_table_109tg_253`,titleCell:`_titleCell_109tg_349`,titleInfo:`_titleInfo_109tg_359`,songTitle:`_songTitle_109tg_371`,genresWrapper:`_genresWrapper_109tg_387`,genreBadge:`_genreBadge_109tg_403`,deleteBtn:`_deleteBtn_109tg_431`,loadingState:`_loadingState_109tg_477`,spinner:`_spinner_109tg_495`,spin:`_spin_109tg_495`,modalOverlay:`_modalOverlay_109tg_545`,fadeIn:`_fadeIn_109tg_1`,modal:`_modal_109tg_545`,slideUp:`_slideUp_109tg_1`,warning:`_warning_109tg_681`,modalActions:`_modalActions_109tg_703`,cancelBtn:`_cancelBtn_109tg_715`,confirmDeleteBtn:`_confirmDeleteBtn_109tg_717`,editModal:`_editModal_109tg_987`,editModalHeader:`_editModalHeader_109tg_997`,editFormGroup:`_editFormGroup_109tg_1005`,editGenreGrid:`_editGenreGrid_109tg_1013`,editModalOverlay:`_editModalOverlay_109tg_1027`,editCloseBtn:`_editCloseBtn_109tg_1113`,editModalContent:`_editModalContent_109tg_1151`,editGenreCheckbox:`_editGenreCheckbox_109tg_1255`,editModalActions:`_editModalActions_109tg_1315`,editCancelBtn:`_editCancelBtn_109tg_1331`,editSaveBtn:`_editSaveBtn_109tg_1333`,editBtn:`_editBtn_109tg_1409`},o=e(r(),1),s=()=>{let[e,n]=(0,i.useState)([]),[r,s]=(0,i.useState)(!0),[l,u]=(0,i.useState)(``),[d,f]=(0,i.useState)({show:!1,song:null}),[p,m]=(0,i.useState)({show:!1,song:null}),[h,g]=(0,i.useState)(``),[_,v]=(0,i.useState)(``),[y,b]=(0,i.useState)([]),[x,S]=(0,i.useState)({title:``,releaseYear:new Date().getFullYear(),genreIds:[]}),[C,w]=(0,i.useState)(!1);(0,i.useEffect)(()=>{T()},[]);let T=async()=>{try{s(!0);let[e,r]=await Promise.all([t.getAllSongs(),t.getAllGenres()]);n(e),b(r),u(``)}catch{u(`Failed to load songs`)}finally{s(!1)}},E=e=>{f({show:!0,song:e})},D=async()=>{if(!d.song)return;let e=d.song;try{await t.deleteSong(e.songId),n(t=>t.filter(t=>t.songId!==e.songId)),f({show:!1,song:null})}catch(e){alert(`Failed to delete song: `+e.message)}},O=()=>{f({show:!1,song:null})},k=e=>{m({show:!0,song:e}),S({title:e.title,releaseYear:e.releaseYear||new Date().getFullYear(),genreIds:e.genres?e.genres.map(e=>e.genreId||e.id):[]})},A=()=>{m({show:!1,song:null}),S({title:``,releaseYear:new Date().getFullYear(),genreIds:[]})},j=e=>{S(t=>({...t,genreIds:t.genreIds.includes(e)?t.genreIds.filter(t=>t!==e):[...t.genreIds,e]}))},M=async()=>{if(p.song){if(!x.title.trim()){alert(`Song title is required`);return}if(x.genreIds.length===0){alert(`At least 1 genre is required`);return}w(!0);try{await t.updateSong(p.song.songId,x.title.trim(),x.releaseYear,x.genreIds),await T(),A(),alert(`Song updated successfully!`)}catch(e){console.error(`Error updating song:`,e),alert(`Failed to update song: `+e.message)}finally{w(!1)}}},N=e.filter(e=>{let t=e.artistName||e.artist?.artistName||``,n=e.title?.toLowerCase().includes(h.toLowerCase())||t.toLowerCase().includes(h.toLowerCase()),r=!_||e.genres&&e.genres.some(e=>e.name===_);return n&&r});return r?(0,o.jsx)(`div`,{className:a.container,children:(0,o.jsxs)(`div`,{className:a.loadingState,children:[(0,o.jsx)(`div`,{className:a.spinner}),(0,o.jsx)(`p`,{children:`Loading all songs...`})]})}):(0,o.jsxs)(`div`,{className:a.container,children:[(0,o.jsxs)(`div`,{className:a.header,children:[(0,o.jsx)(`h1`,{children:`ðŸŽµ Song Management`}),(0,o.jsx)(`p`,{children:`Manage all songs in the platform`})]}),l&&(0,o.jsxs)(`div`,{className:a.error,children:[l,(0,o.jsx)(`button`,{onClick:T,style:{marginLeft:`10px`},children:`Retry`})]}),(0,o.jsxs)(`div`,{className:a.controls,children:[(0,o.jsx)(`input`,{type:`text`,placeholder:`Search by title or artist...`,value:h,onChange:e=>g(e.target.value),className:a.searchInput}),(0,o.jsxs)(`select`,{value:_,onChange:e=>v(e.target.value),className:a.filterSelect,children:[(0,o.jsx)(`option`,{value:``,children:`All Genres`}),y.map(e=>(0,o.jsx)(`option`,{value:e.name,children:e.name},e.genreId||e.id||`genre-${e.name}`))]}),(0,o.jsxs)(`div`,{className:a.stats,children:[`Showing: `,(0,o.jsx)(`strong`,{children:N.length}),` / `,e.length,` songs`]})]}),N.length===0?(0,o.jsx)(`div`,{className:a.empty,children:h||_?`No songs found matching your criteria`:`No songs available`}):(0,o.jsx)(`div`,{className:a.tableContainer,children:(0,o.jsxs)(`table`,{className:a.table,children:[(0,o.jsx)(`thead`,{children:(0,o.jsxs)(`tr`,{children:[(0,o.jsx)(`th`,{children:`Title`}),(0,o.jsx)(`th`,{children:`Artist`}),(0,o.jsx)(`th`,{children:`Genre`}),(0,o.jsx)(`th`,{children:`Year`}),(0,o.jsx)(`th`,{children:`Duration`}),(0,o.jsx)(`th`,{children:`Actions`})]})}),(0,o.jsx)(`tbody`,{children:N.map(e=>(0,o.jsxs)(`tr`,{children:[(0,o.jsx)(`td`,{className:a.titleCell,children:(0,o.jsx)(`div`,{className:a.titleInfo,children:(0,o.jsx)(`span`,{className:a.songTitle,children:e.title})})}),(0,o.jsx)(`td`,{children:e.artistName||e.artist?.artistName||`Unknown Artist`}),(0,o.jsx)(`td`,{children:e.genres&&e.genres.length>0?(0,o.jsx)(`div`,{className:a.genresWrapper,children:e.genres.map((t,n)=>{let r=t.genreId?`${e.songId}-${t.genreId}`:`${e.songId}-${t.name}-${n}`;return(0,o.jsx)(`span`,{className:a.genreBadge,children:t.name},r)})}):(0,o.jsx)(`span`,{className:a.genreBadge,children:`Unknown`})}),(0,o.jsx)(`td`,{children:e.releaseYear||`N/A`}),(0,o.jsx)(`td`,{children:c(e.duration)}),(0,o.jsxs)(`td`,{children:[(0,o.jsx)(`button`,{onClick:()=>k(e),className:a.editBtn,title:`Edit "${e.title}"`,children:`âœï¸ Edit`}),(0,o.jsx)(`button`,{onClick:()=>E(e),className:a.deleteBtn,title:`Delete "${e.title}"`,children:`ðŸ—‘ï¸ Delete`})]})]},e.songId))})]})}),d.show&&d.song&&(0,o.jsx)(`div`,{className:a.modalOverlay,onClick:O,children:(0,o.jsxs)(`div`,{className:a.modal,onClick:e=>e.stopPropagation(),children:[(0,o.jsx)(`h2`,{children:`âš ï¸ Delete Song`}),(0,o.jsxs)(`p`,{children:[`Are you sure you want to delete`,` `,(0,o.jsxs)(`strong`,{children:[`"`,d.song.title,`"`]}),` by`,` `,(0,o.jsx)(`strong`,{children:d.song.artistName||d.song.artist?.artistName||`Unknown`}),`?`]}),(0,o.jsx)(`p`,{className:a.warning,children:`âš ï¸ This action is permanent and cannot be undone. The song will be removed from all playlists.`}),(0,o.jsxs)(`div`,{className:a.modalActions,children:[(0,o.jsx)(`button`,{onClick:O,className:a.cancelBtn,children:`Cancel`}),(0,o.jsx)(`button`,{onClick:D,className:a.confirmDeleteBtn,children:`Delete Permanently`})]})]})}),p.show&&p.song&&(0,o.jsx)(`div`,{className:a.editModalOverlay,onClick:A,children:(0,o.jsxs)(`div`,{className:a.editModal,onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)(`div`,{className:a.editModalHeader,children:[(0,o.jsx)(`h2`,{children:`Edit Song`}),(0,o.jsx)(`button`,{type:`button`,className:a.editCloseBtn,onClick:A,children:`âœ•`})]}),(0,o.jsxs)(`div`,{className:a.editModalContent,children:[(0,o.jsxs)(`div`,{className:a.editFormGroup,children:[(0,o.jsx)(`label`,{children:`Song Title *`}),(0,o.jsx)(`input`,{type:`text`,value:x.title,onChange:e=>S(t=>({...t,title:e.target.value})),placeholder:`Song title`,disabled:C,autoFocus:!0})]}),(0,o.jsxs)(`div`,{className:a.editFormGroup,children:[(0,o.jsx)(`label`,{children:`Release Year *`}),(0,o.jsx)(`input`,{type:`number`,value:x.releaseYear,onChange:e=>S(t=>({...t,releaseYear:parseInt(e.target.value)})),min:`1900`,max:new Date().getFullYear()+1,disabled:C})]}),(0,o.jsxs)(`div`,{className:a.editFormGroup,children:[(0,o.jsx)(`label`,{children:`Genres (Required *)`}),(0,o.jsx)(`div`,{className:a.editGenreGrid,children:y.map(e=>{let t=e.genreId||e.id;return(0,o.jsxs)(`label`,{className:a.editGenreCheckbox,children:[(0,o.jsx)(`input`,{type:`checkbox`,checked:x.genreIds.includes(t),onChange:()=>j(t),disabled:C}),(0,o.jsx)(`span`,{children:e.name})]},t)})})]}),(0,o.jsxs)(`div`,{className:a.editModalActions,children:[(0,o.jsx)(`button`,{className:a.editCancelBtn,onClick:A,disabled:C,children:`Cancel`}),(0,o.jsx)(`button`,{className:a.editSaveBtn,onClick:M,disabled:C,children:C?`Saving...`:`Save Changes`})]})]})]})})]})},c=e=>!e||e===0?`0:00`:`${Math.floor(e/60)}:${(e%60).toString().padStart(2,`0`)}`,l=s;export{l as default};